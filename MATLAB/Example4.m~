% specify problem
sigma = .2;

% spacial discritization
a = 0;
b = 2*pi;
Nx = 200;
deltaX = (b-a)/Nx;
x = ((1:Nx)-(1/2))*deltaX;

% set up parameters for method
alpha = 4;
N = 7;
epsilon = 1e-6;

% get initial values of p
p0 = zeros(N+1,Nx);
p0(1,:) = cos()
if N > 0
    p0(2,:) = sigma;
end

% set ending time
T = .3;
q = HamiltonJacobiInstantRelaxation(alpha, @(p)HExample1(p,S), N, Nx, deltaX, p0, T, epsilon, @LaxWendroff);

figure
subplot(2,2,1)
hold on
plot(x,deltaX*cumsum(q(1,:,end)), 'r')
xlim([.3,.7]);
title('Eu');
subplot(2,2,2)
plot(x,deltaX*cumsum(q(2,:,end)),'r')
title('Su');
xlim([.3,.7]);
hold on
subplot(2,2,3)
plot(x,q(1,:,end),'r')
title('Ep');
xlim([.3,.7]);
hold on
subplot(2,2,4)
plot(x,q(2,:,end),'r')
title('Sp')
xlim([.3,.7])
hold off