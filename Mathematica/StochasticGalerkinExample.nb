(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8555,        253]
NotebookOptionsPosition[      8274,        238]
NotebookOutlinePosition[      8655,        255]
CellTagsIndexPosition[      8612,        252]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"setup", " ", "differential", " ", "equation"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"u", "'"}], "[", "t", "]"}], " ", "\[Equal]", " ", 
     RowBox[{
      RowBox[{"-", "\[Alpha]"}], " ", 
      RowBox[{"u", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "0", "]"}], "\[Equal]", "\[Beta]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"alpha", " ", "is", " ", "normally", " ", "distributed"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Mu]", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", "[", "z_", "]"}], ":=", 
     RowBox[{"\[Mu]", " ", "+", " ", 
      RowBox[{"\[Sigma]", " ", "z"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"beta", " ", "is", " ", "deterministic"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Beta]", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "both", " ", "alpha", " ", "and", " ", "beta", " ", "need", " ", "to", 
     " ", "be", " ", "projected", " ", "onto", " ", "a", " ", "basis", " ", 
     "of", " ", "Hermite", " ", "polynomials"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "[", "i_", "]"}], ":=", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"HermiteH", "[", 
         RowBox[{"i", ",", "z"}], "]"}], "2"], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         SuperscriptBox["z", "2"]}]], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"a", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", 
        RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
       RowBox[{
        RowBox[{"\[Alpha]", "[", "z", "]"}], 
        RowBox[{"HermiteH", "[", 
         RowBox[{"i", ",", "z"}], "]"}], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          SuperscriptBox["z", "2"]}]], 
        RowBox[{"\[DifferentialD]", "z"}]}]}], ")"}], "/", 
     RowBox[{"\[Gamma]", "[", "i", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", 
        RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
       RowBox[{"\[Beta]", " ", 
        RowBox[{"HermiteH", "[", 
         RowBox[{"i", ",", "z"}], "]"}], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          SuperscriptBox["z", "2"]}]], 
        RowBox[{"\[DifferentialD]", "z"}]}]}], ")"}], "/", 
     RowBox[{"\[Gamma]", "[", "i", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]N", "[", 
     RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "0"}], "n"], 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], 
      RowBox[{"HermiteH", "[", 
       RowBox[{"i", ",", "z"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vN", "[", 
     RowBox[{"n_", ",", "t_", ",", "z_"}], "]"}], ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "0"}], "n"], 
     RowBox[{
      RowBox[{"vhat", "[", 
       RowBox[{"i", ",", "t"}], "]"}], "*", 
      RowBox[{"HermiteH", "[", 
       RowBox[{"i", ",", "z"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "By", " ", "substituting", " ", "vN", " ", "for", " ", "u", " ", "and", 
     " ", "\[Alpha]N", " ", "for", " ", "\[Alpha]", " ", "into", " ", "the", 
     " ", "differential", " ", "equation", " ", "the", " ", "following", " ", 
     "arrives"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"vN", "[", 
         RowBox[{"n", ",", "t", ",", "z"}], "]"}], ",", "t"}], "]"}], " ", 
      "\[Equal]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Alpha]N", "[", 
         RowBox[{"n", ",", "z"}], "]"}]}], 
       RowBox[{"vN", "[", 
        RowBox[{"n", ",", "t", ",", "z"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"vN", "[", 
         RowBox[{"n", ",", "t", ",", "z"}], "]"}], ",", "t"}], "]"}], " ", 
      RowBox[{"HermiteH", "[", 
       RowBox[{"k", ",", "z"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        SuperscriptBox["z", "2"]}]]}], "\[Equal]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"\[Alpha]N", "[", 
        RowBox[{"n", ",", "z"}], "]"}]}], 
      RowBox[{"vN", "[", 
       RowBox[{"n", ",", "t", ",", "z"}], "]"}], 
      RowBox[{"HermiteH", "[", 
       RowBox[{"k", ",", "z"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        SuperscriptBox["z", "2"]}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq2", "=", 
     RowBox[{
      RowBox[{
       SubsuperscriptBox["\[Integral]", 
        RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"vN", "[", 
           RowBox[{"n", ",", "t", ",", "z"}], "]"}], ",", "t"}], "]"}], " ", 
        RowBox[{"HermiteH", "[", 
         RowBox[{"k", ",", "z"}], "]"}], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          SuperscriptBox["z", "2"]}]], 
        RowBox[{"\[DifferentialD]", "z"}]}]}], "\[Equal]", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", 
        RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Alpha]N", "[", 
          RowBox[{"n", ",", "z"}], "]"}]}], 
        RowBox[{"vN", "[", 
         RowBox[{"n", ",", "t", ",", "z"}], "]"}], 
        RowBox[{"HermiteH", "[", 
         RowBox[{"k", ",", "z"}], "]"}], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          SuperscriptBox["z", "2"]}]], 
        RowBox[{"\[DifferentialD]", "z"}]}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"vhat", "[", 
         RowBox[{"k", ",", "t"}], "]"}], ",", "t"}], "]"}], 
      RowBox[{"\[Gamma]", "[", "k", "]"}]}], "\[Equal]", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Alpha]N", "[", 
         RowBox[{"n", ",", "z"}], "]"}]}], 
       RowBox[{"vN", "[", 
        RowBox[{"n", ",", "t", ",", "z"}], "]"}], 
       RowBox[{"HermiteH", "[", 
        RowBox[{"k", ",", "z"}], "]"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         SuperscriptBox["z", "2"]}]], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQ/W/C6z+6Xq8dTyXXMukB6ZKgZ7wgWrLxJB+Iviik
JQKieWxLwbTI1q1SIPq/cIAsiJ7wossYRMfMtrUA0QfadBxAdN2xdhcQ/aGZ
3Q9ER9c0RIHoWe+2JYLoSw9uZIFooc2vC0E018rXdSC6Yuv6fhC9j3P6JBD9
5kzxNBD9awn3LBDNf0TkEIguP8N1AkQvcHt+GkSvC5t6EUSv1F9zE0RfjroG
pqs62z+AaJYdvl9AtJ1yw1+w+Zv/MuoD6R+m+0RA9P3NOyRBdH37P20Qva9k
vjuIFvrD9whEP5099QuIvhGl9QdEX2Z9xWEApAF/wpdZ
  "]]
},
WindowSize->{1280, 751},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>2. Inherited,
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 6, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 7712, 216, 1250, "Input"]
}
]
*)

(* End of internal cache information *)
