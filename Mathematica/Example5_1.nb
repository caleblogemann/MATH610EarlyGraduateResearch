(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12476,        377]
NotebookOptionsPosition[     11063,        325]
NotebookOutlinePosition[     11832,        354]
CellTagsIndexPosition[     11706,        348]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData["??"], "Input",
 CellChangeTimes->{{3.664721306864047*^9, 3.6647213093697042`*^9}, {
   3.664721536298077*^9, 3.664721544759389*^9}, {3.664721625093369*^9, 
   3.664721625257142*^9}, 3.664721978403862*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox["\<\"\\!\\(\\*RowBox[{\\\"LegendreP\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"n\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"x\\\", \
\\\"TI\\\"]}], \\\"]\\\"}]\\) gives the Legendre polynomial \
\\!\\(\\*RowBox[{SubscriptBox[StyleBox[\\\"P\\\", \\\"TI\\\"], StyleBox[\\\"n\
\\\", \\\"TI\\\"]], \\\"(\\\", StyleBox[\\\"x\\\", \\\"TI\\\"], \
\\\")\\\"}]\\). \\n\\!\\(\\*RowBox[{\\\"LegendreP\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"n\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"m\\\", \
\\\"TI\\\"], \\\",\\\", StyleBox[\\\"x\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) \
gives the associated Legendre polynomial \
\\!\\(\\*RowBox[{SubsuperscriptBox[StyleBox[\\\"P\\\", \\\"TI\\\"], StyleBox[\
\\\"n\\\", \\\"TI\\\"], StyleBox[\\\"m\\\", \\\"TI\\\"]], \\\"(\\\", \
StyleBox[\\\"x\\\", \\\"TI\\\"], \\\")\\\"}]\\). \"\>", "MSG"], 
  "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->"paclet:ref/LegendreP"]}]], "Print", "PrintUsage",
 CellChangeTimes->{3.664721625732554*^9},
 CellTags->"Info3664700025-2038944"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     RowBox[{
      RowBox[{"Attributes", "[", "LegendreP", "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
       "Listable", ",", "NumericFunction", ",", "Protected", ",", 
        "ReadProtected"}], "}"}]}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[LegendreP],
  Editable->False]], "Print",
 CellChangeTimes->{3.664721625793026*^9},
 CellTags->"Info3664700025-2038944"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     RowBox[{
      RowBox[{"Attributes", "[", "LegendreQ", "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
       "Listable", ",", "NumericFunction", ",", "Protected", ",", 
        "ReadProtected"}], "}"}]}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[LegendreQ],
  Editable->False]], "Print",
 CellChangeTimes->{3.6647216379001102`*^9},
 CellTags->"Info3664700037-2038944"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       RowBox[{"-", "1"}], "1"], 
      RowBox[{
       RowBox[{"LegendreP", "[", 
        RowBox[{"i", ",", "z"}], "]"}], 
       RowBox[{"LegendreP", "[", 
        RowBox[{"j", ",", "z"}], "]"}], 
       RowBox[{"LegendreP", "[", 
        RowBox[{"k", ",", "z"}], "]"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}], ")"}], "/", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      RowBox[{"-", "1"}], "1"], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"LegendreP", "[", 
        RowBox[{"k", ",", "z"}], "]"}], "2"], 
      RowBox[{"\[DifferentialD]", "z"}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.664721551987879*^9, 3.664721581636051*^9}, {
  3.6647217726706667`*^9, 3.664721799472481*^9}, {3.664891613504414*^9, 
  3.664891618015065*^9}, {3.664893258041686*^9, 3.6648932583559093`*^9}, {
  3.664895702467085*^9, 3.6648957918107777`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sTable", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"i", ",", "j", ",", "k"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "7"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<S.mat\>\"", ",", "sTable"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.664895772234797*^9, 3.66489580994081*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sTable", "[", 
   RowBox[{"[", 
    RowBox[{";;", ",", "2", ",", ";;"}], "]"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.66489165079335*^9, 3.664891702993238*^9}, {
  3.664891876825377*^9, 3.664891882337936*^9}, {3.6648920197474823`*^9, 
  3.6648920402298727`*^9}, {3.665232065383353*^9, 3.665232106714505*^9}, {
  3.6652321430947742`*^9, 3.665232184265749*^9}, {3.665232383263749*^9, 
  3.665232407108953*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {
      FractionBox["1", "3"], "0", 
      FractionBox["2", "3"], "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox["2", "5"], "0", 
      FractionBox["3", "5"], "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox["3", "7"], "0", 
      FractionBox["4", "7"], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["4", "9"], "0", 
      FractionBox["5", "9"], "0", "0"},
     {"0", "0", "0", "0", 
      FractionBox["5", "11"], "0", 
      FractionBox["6", "11"], "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["6", "13"], "0", 
      FractionBox["7", "13"]},
     {"0", "0", "0", "0", "0", "0", 
      FractionBox["7", "15"], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.664891672234001*^9, 3.6648917033615913`*^9}, {
   3.6648918786355667`*^9, 3.664891882555902*^9}, {3.664892023721923*^9, 
   3.664892040509276*^9}, 3.664895811611142*^9, {3.6652320676101007`*^9, 
   3.665232107130254*^9}, {3.665232143485025*^9, 3.665232184625224*^9}, {
   3.6652323908824778`*^9, 3.66523240746555*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Integral]", 
   RowBox[{"-", "1"}], "1"], 
  RowBox[{
   RowBox[{"LegendreP", "[", 
    RowBox[{"4", ",", "x"}], "]"}], 
   RowBox[{"LegendreP", "[", 
    RowBox[{"4", ",", "x"}], "]"}], 
   RowBox[{"\[DifferentialD]", "x"}]}]}]], "Input",
 CellChangeTimes->{{3.66472158395732*^9, 3.664721610182137*^9}, {
  3.6647217183229513`*^9, 3.664721752041388*^9}, {3.6648932720399437`*^9, 
  3.664893272199275*^9}}],

Cell[BoxData[
 FractionBox["2", "9"]], "Output",
 CellChangeTimes->{{3.664721600345203*^9, 3.664721610410386*^9}, {
   3.664721724828857*^9, 3.664721752321167*^9}, 3.664893272507215*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ul", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ur", " ", "=", 
   RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]", " ", "=", ".1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "[", 
   RowBox[{"x_", ",", "t_", ",", "z_"}], "]"}], ":=", 
  TagBox[GridBox[{
     {"\[Piecewise]", GridBox[{
        {
         RowBox[{"ul", " ", "+", " ", 
          RowBox[{"\[Sigma]", " ", "z"}]}], 
         RowBox[{"x", " ", "\[LessEqual]", 
          RowBox[{".5", " ", "+", " ", 
           RowBox[{"\[Sigma]", " ", "z", " ", "t"}]}]}]},
        {
         RowBox[{"ur", " ", "+", " ", 
          RowBox[{"\[Sigma]", " ", "z"}]}], 
         RowBox[{"x", ">", 
          RowBox[{".5", " ", "+", " ", 
           RowBox[{"\[Sigma]", " ", "z", " ", "t"}]}]}]}
       },
       AllowedDimensions->{2, Automatic},
       Editable->True,
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.84]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}},
       Selectable->True]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxItemSize->{
     "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.35]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   "Piecewise",
   DeleteWithContents->True,
   Editable->False,
   SelectWithContents->True,
   Selectable->False]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pHat", "[", 
   RowBox[{"x_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      RowBox[{"-", "1"}], "1"], 
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"x", ",", "0", ",", "z"}], "]"}], "*", 
      RowBox[{"LegendreP", "[", 
       RowBox[{"k", ",", "z"}], "]"}], 
      RowBox[{"\[DifferentialD]", "z"}]}]}], ")"}], "/", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{"-", "1"}], "1"], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"LegendreP", "[", 
       RowBox[{"k", ",", "z"}], "]"}], "2"], 
     RowBox[{"\[DifferentialD]", "z"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.664893291404228*^9, 3.664893513513331*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pHat", "[", 
  RowBox[{"x", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.6648933886325397`*^9, 3.664893390780643*^9}, {
  3.6648935184153767`*^9, 3.6648935868296947`*^9}, {3.6648962095826178`*^9, 
  3.664896225210683*^9}}],

Cell[BoxData["0.1`"], "Output",
 CellChangeTimes->{{3.6648935267015543`*^9, 3.664893587125441*^9}, {
  3.664896214780006*^9, 3.6648962271835127`*^9}}]
}, Open  ]]
},
WindowSize->{1920, 1056},
WindowMargins->{{43, Automatic}, {Automatic, 0}},
Magnification:>2. Inherited,
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info3664700025-2038944"->{
  Cell[823, 29, 1107, 21, 113, "Print",
   CellTags->"Info3664700025-2038944"],
  Cell[1933, 52, 568, 17, 41, "Print",
   CellTags->"Info3664700025-2038944"]},
 "Info3664700037-2038944"->{
  Cell[2504, 71, 570, 17, 41, "Print",
   CellTags->"Info3664700037-2038944"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info3664700025-2038944", 11414, 337},
 {"Info3664700037-2038944", 11603, 342}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 218, 3, 56, "Input"],
Cell[CellGroupData[{
Cell[823, 29, 1107, 21, 113, "Print",
 CellTags->"Info3664700025-2038944"],
Cell[1933, 52, 568, 17, 41, "Print",
 CellTags->"Info3664700025-2038944"],
Cell[2504, 71, 570, 17, 41, "Print",
 CellTags->"Info3664700037-2038944"]
}, Open  ]]
}, Open  ]],
Cell[3101, 92, 1062, 29, 93, "Input"],
Cell[4166, 123, 728, 21, 123, "Input"],
Cell[CellGroupData[{
Cell[4919, 148, 469, 10, 56, "Input"],
Cell[5391, 160, 1598, 41, 456, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7026, 206, 453, 12, 93, "Input"],
Cell[7482, 220, 186, 3, 83, "Output"]
}, Open  ]],
Cell[7683, 226, 2934, 83, 267, "Input"],
Cell[CellGroupData[{
Cell[10642, 313, 252, 5, 56, "Input"],
Cell[10897, 320, 150, 2, 56, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
